/**
 * OfficePaste for TinyMCE Plugin
 * Copyright (C) 2020-2024 grommunio GmbH <dev@grommunio.com>
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("tinymce")):"function"==typeof define&&define.amd?define(["tinymce"],t):"object"==typeof exports?exports["tinymce-officepaste-plugin"]=t(require("tinymce")):e["tinymce-officepaste-plugin"]=t(e.tinymce)}(this,(function(e){"use strict";e.PluginManager.add("officepaste",(function(e){e.on("PastePreProcess",(function(t){let n=function(e){const t=document.createElement("div");t.innerHTML=e;const n=t.querySelectorAll("p");for(let e=0;e<n.length;e++){const t=n[e];if(""===t.innerHTML.trim()||"&nbsp;"===t.innerHTML.trim()){const e=document.createElement("br");t.parentNode.replaceChild(e,t)}else t.style.margin="0",t.style.padding="0",parseFloat(t.style.textIndent)<0&&(t.style.textIndent="0")}return t.innerHTML}(t.content);t.preventDefault(),e.execCommand("mceInsertContent",!1,n),setTimeout((()=>{e.selection.collapse(!1)}),0)}))}))}));
